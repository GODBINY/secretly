<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>🤔</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="app-container">
    <!-- 사이드바: 방 목록 -->
    <div class="sidebar">
      <div class="sidebar-header">
        <div class="sidebar-header-top">
          <h2>🧡</h2>
          <button id="themeSettingsBtn" class="btn-theme-settings" title="테마 설정">⚙️</button>
        </div>
        <button id="createRoomBtn" class="btn-create-room">+ 방 만들기</button>
      </div>
      <div class="rooms-list" id="roomsList">
        <!-- 방 목록이 여기에 동적으로 추가됩니다 -->
      </div>
      
      <!-- 공지 및 답변 섹션 (사이드바 하단) -->
      <div class="sidebar-notice-section" id="noticeSection">
        <div class="sidebar-notice-header">
          <h4>📌 공지</h4>
          <button id="setNoticeBtn" class="btn-small-sidebar">등록</button>
        </div>
        <div class="sidebar-notice-content" id="noticeContent">
          <p class="no-notice">공지가 없습니다.</p>
        </div>
        <div class="sidebar-answers-section" id="answersSection">
          <!-- 답변 목록이 여기에 표시됩니다 -->
        </div>
        <div class="sidebar-answer-input" id="answerInput" style="display: none;">
          <input type="text" id="answerText" placeholder="답변...">
          <button id="submitAnswerBtn">답변</button>
        </div>
        <div id="noticeActions" style="display: none;">
          <button id="editNoticeBtn" class="btn-small-sidebar btn-edit">수정</button>
          <button id="deleteNoticeBtn" class="btn-small-sidebar btn-delete">삭제</button>
        </div>
      </div>
    </div>

    <!-- 메인 채팅 영역 -->
    <div class="main-content">
      <!-- 채팅 메시지 영역 -->
      <div class="chat-container" id="chatContainer">
        <div class="chat-header">
          <h3 id="currentRoomName">일반</h3>
          <div class="chat-header-actions">
            <button id="clearAllMessagesBtn" class="btn-clear-all" title="전체 메시지 삭제" style="display: none;">🗑️ 전체 삭제</button>
            <div class="typing-indicator" id="typingIndicator"></div>
          </div>
        </div>
        <div class="messages" id="messages">
          <!-- 메시지가 여기에 표시됩니다 -->
        </div>
        <div class="input-area" id="inputArea">
          <input type="text" id="messageInput" placeholder="메시지를 입력하세요...">
          <button id="sendBtn">전송</button>
        </div>
      </div>

      <!-- 실시간 공유방 영역 -->
      <div class="live-container" id="liveContainer" style="display: none;">
        <div class="live-header">
          <h3 id="liveRoomName">실시간 공유</h3>
          <p class="live-description">할 말을 입력하면 자동으로 구역이 생성되고 실시간으로 공유됩니다!</p>
        </div>
        <div class="live-sections" id="liveSections">
          <!-- 구역별 섹션이 여기에 표시됩니다 -->
        </div>
        <div class="live-input-area">
          <textarea id="liveInput" placeholder="할 말을 입력하세요... (실시간으로 공유됩니다, @로 태깅 가능)"></textarea>
          <div id="mentionAutocomplete" class="mention-autocomplete" style="display: none;">
            <!-- 자동완성 목록이 여기에 표시됩니다 -->
          </div>
          <div class="live-input-actions">
            <button id="clearLiveBtn">내 내용 지우기</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- 방 생성 모달 -->
  <div class="modal" id="createRoomModal">
    <div class="modal-content">
      <h3>새 방 만들기</h3>
      <input type="text" id="roomNameInput" placeholder="방 이름을 입력하세요">
      <div class="room-type-selector">
        <label class="room-type-option">
          <input type="radio" name="roomType" value="chat" checked>
          <span>💬 채팅방</span>
          <small>메시지가 쌓이는 일반 채팅방</small>
        </label>
        <label class="room-type-option">
          <input type="radio" name="roomType" value="live">
          <span>⚡ 실시간 공유방</span>
          <small>각자 할 말을 실시간으로 공유하고 계속 지우는 방</small>
        </label>
      </div>
      <div class="modal-buttons">
        <button id="confirmCreateBtn" class="btn-primary">만들기</button>
        <button id="cancelCreateBtn" class="btn-secondary">취소</button>
      </div>
    </div>
  </div>

  <!-- 공지 등록 모달 -->
  <div class="modal" id="noticeModal">
    <div class="modal-content">
      <h3>공지 등록</h3>
      <textarea id="noticeTextInput" placeholder="공지 내용을 입력하세요"></textarea>
      <div class="modal-buttons">
        <button id="confirmNoticeBtn" class="btn-primary">등록</button>
        <button id="cancelNoticeBtn" class="btn-secondary">취소</button>
      </div>
    </div>
  </div>

  <!-- 서버 주소 입력 모달 -->
  <div class="modal" id="serverUrlModal">
    <div class="modal-content">
      <h3>서버 주소 입력</h3>
      <p style="font-size: 13px; color: #666; margin-bottom: 15px;">서버 운영자에게 받은 서버 주소를 입력하세요</p>
      <input type="text" id="serverUrlInput" placeholder="https://192.168.1.100:3000" value="https://localhost:3000">
      <div class="modal-buttons">
        <button id="confirmServerUrlBtn" class="btn-primary">연결</button>
      </div>
    </div>
  </div>

  <!-- 설정 메뉴 모달 -->
  <div class="modal" id="settingsModal">
    <div class="modal-content">
      <h3>설정</h3>
      <div class="settings-menu">
        <button class="settings-menu-item" id="themeSettingsMenuItem">
          <span>🎨</span>
          <div>
            <strong>테마 선택</strong>
            <small>앱의 색상 테마를 변경합니다</small>
          </div>
        </button>
        <button class="settings-menu-item" id="userInfoMenuItem">
          <span>👤</span>
          <div>
            <strong>내 정보 수정</strong>
            <small>아이디와 이모티콘을 변경합니다</small>
          </div>
        </button>
      </div>
      <div class="modal-buttons">
        <button id="closeSettingsBtn" class="btn-secondary">닫기</button>
      </div>
    </div>
  </div>

  <!-- 테마 설정 모달 -->
  <div class="modal" id="themeModal">
    <div class="modal-content">
      <h3>테마 설정</h3>
      <div class="theme-selector">
        <label class="theme-option">
          <input type="radio" name="theme" value="default" checked>
          <span>🌞 기본 모드</span>
          <small>밝고 깔끔한 기본 테마</small>
        </label>
        <label class="theme-option">
          <input type="radio" name="theme" value="dark">
          <span>🌙 다크 모드</span>
          <small>눈에 편안한 어두운 테마</small>
        </label>
        <label class="theme-option">
          <input type="radio" name="theme" value="terminal">
          <span>💻 터미널 모드</span>
          <small>터미널처럼 보이는 테마 (일하다 들키면 안되니까 ㅎㅎ)</small>
        </label>
      </div>
      <div class="modal-buttons">
        <button id="confirmThemeBtn" class="btn-primary">적용</button>
        <button id="cancelThemeBtn" class="btn-secondary">취소</button>
      </div>
    </div>
  </div>

  <!-- 내 정보 수정 모달 -->
  <div class="modal" id="userInfoModal">
    <div class="modal-content">
      <h3>내 정보 수정</h3>
      <div style="margin-bottom: 15px;">
        <label style="font-size: 13px; color: #666; margin-bottom: 5px; display: block;">아이디:</label>
        <input type="text" id="userInfoUserIdInput" readonly 
               style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px; background: #f5f5f5;">
      </div>
      <div style="margin-bottom: 15px;">
        <label style="font-size: 13px; color: #666; margin-bottom: 5px; display: block;">이모티콘 (선택사항):</label>
        <div class="emoji-picker-container">
          <div class="emoji-picker" id="userInfoEmojiPicker">
            <!-- 이모티콘이 여기에 동적으로 추가됩니다 -->
          </div>
        </div>
        <div style="margin-top: 10px; padding-top: 10px; border-top: 1px solid #ddd;">
          <label style="font-size: 12px; color: #666; margin-bottom: 5px; display: block;">또는 직접 입력:</label>
          <input type="text" id="userInfoEmojiInput" placeholder="원하는 이모티콘을 입력하세요 (예: 🎉, 🚀, 💻)" 
                 style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; font-size: 16px;"
                 maxlength="10">
          <small style="font-size: 11px; color: #999; display: block; margin-top: 5px;">
            💡 팁: Windows는 Win + . (마침표), Mac은 Control + Command + Space로 이모티콘 키보드를 열 수 있습니다
          </small>
        </div>
        <div class="selected-emoji-preview" id="userInfoEmojiPreview">이모티콘을 선택하거나 입력하세요 (선택사항)</div>
      </div>
      <div class="modal-buttons">
        <button id="confirmUserInfoBtn" class="btn-primary">적용</button>
        <button id="cancelUserInfoBtn" class="btn-secondary">취소</button>
      </div>
    </div>
  </div>

  <!-- 사용자 설정 모달 -->
  <div class="modal" id="nicknameModal">
    <div class="modal-content">
      <h3>사용자 설정</h3>
      <div style="margin-bottom: 15px;">
        <label style="font-size: 13px; color: #666; margin-bottom: 5px; display: block;">아이디 (필수):</label>
        <input type="text" id="userIdInput" placeholder="아이디를 입력하세요" maxlength="20" 
               style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;">
      </div>
      <div style="margin-bottom: 15px;">
        <label style="font-size: 13px; color: #666; margin-bottom: 5px; display: block;">이모티콘 (선택사항):</label>
        <div class="emoji-picker-container">
          <div class="emoji-picker" id="emojiPicker">
            <!-- 이모티콘이 여기에 동적으로 추가됩니다 -->
          </div>
        </div>
        <div style="margin-top: 10px; padding-top: 10px; border-top: 1px solid #ddd;">
          <label style="font-size: 12px; color: #666; margin-bottom: 5px; display: block;">또는 직접 입력:</label>
          <input type="text" id="emojiInput" placeholder="원하는 이모티콘을 입력하세요 (예: 🎉, 🚀, 💻)" 
                 style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; font-size: 16px;"
                 maxlength="10">
          <small style="font-size: 11px; color: #999; display: block; margin-top: 5px;">
            💡 팁: Windows는 Win + . (마침표), Mac은 Control + Command + Space로 이모티콘 키보드를 열 수 있습니다
          </small>
        </div>
        <div class="selected-emoji-preview" id="selectedEmojiPreview">이모티콘을 선택하거나 입력하세요 (선택사항)</div>
      </div>
      <div class="modal-buttons">
        <button id="confirmNicknameBtn" class="btn-primary">확인</button>
      </div>
    </div>
  </div>

  <script src="https://cdn.socket.io/4.6.1/socket.io.min.js"></script>
  <script src="app.js"></script>
</body>
</html>

